{"version":3,"sources":["admin/page-calendar.js"],"names":["$","plugin","window","awebooking","DATE_FORMAT","BookingScheduler","flatpickr","scheduler","ScheduleCalendar","el","debug","granularity","$dialog","dialog","modal","width","height","autoOpen","draggable","resizable","closeOnEscape","dialogClass","position","my","at","of","on","handleClearSelected","bind","handleBlockRoom","handleUnblockRoom","swal","close","e","model","compileHtmlControls","confirm","i18n","warning","action","state","template","wp","$form","html","endDate","get","format","startDate","calendar","dateFormat","plugins","rangePlugin","input","jQuery"],"mappings":"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","sourcesContent":["(function($) {\n  'use strict';\n\n  const plugin = window.awebooking || {};\n  const DATE_FORMAT  = 'YYYY-MM-DD';\n\n  class BookingScheduler {\n    /**\n     * Constructor.\n     *\n     * @return {void}\n     */\n    constructor() {\n      this.flatpickr = null;\n\n      this.scheduler = new ScheduleCalendar({\n        el: '.scheduler',\n        debug: plugin.debug,\n        granularity: 'nightly',\n      });\n\n      this.$dialog = $('#scheduler-form-dialog').dialog({\n        modal: true,\n        width: 'auto',\n        height: 'auto',\n        autoOpen: false,\n        draggable: false,\n        resizable: false,\n        closeOnEscape: true,\n        dialogClass: 'wp-dialog awebooking-dialog',\n        position: { my: 'center', at: 'center center-15%', of: window },\n      });\n\n      this.scheduler.on('clear', this.handleClearSelected.bind(this));\n      this.scheduler.on('action:set-unavailable', this.handleBlockRoom.bind(this));\n      this.scheduler.on('action:clear-unavailable', this.handleUnblockRoom.bind(this));\n    }\n\n    /**\n     * Handle on clear selected.\n     *\n     * @return {void}\n     */\n    handleClearSelected() {\n      window.swal && swal.close();\n    }\n\n    /**\n     * Handle set price action.\n     *\n     * @param  {Event}  e\n     * @param  {Object} model\n     * @return {void}\n     */\n    handleBlockRoom(e, model) {\n      window.swal && swal.close();\n\n      this.compileHtmlControls('block_room', 0);\n\n      this.$dialog.dialog('open');\n    }\n\n    /**\n     * Handle reset price action.\n     *\n     * @param  {Event}  e\n     * @param  {Object} model\n     * @return {void}\n     */\n    handleUnblockRoom(e, model) {\n      plugin.confirm(plugin.i18n.warning, () => {\n        // const $form = this.compileHtmlControls('reset_price', 0);\n        // $form.closest('form').submit();\n      });\n    }\n\n    /**\n     * Compile html form controls.\n     *\n     * @param  {string} action\n     * @param  {string} state\n     * @return {void}\n     */\n    compileHtmlControls(action, state) {\n      const model = this.scheduler.model;\n      const template = wp.template('scheduler-pricing-controls');\n\n      // Destroy flatpickr first.\n      if (this.flatpickr) {\n        // this.flatpickr.destroy();\n      }\n\n      // Compile the html template.\n      const $form = $('#js-scheduler-form-controls').html(template({\n        state:     state,\n        action:    action,\n        endDate:   model.get('endDate').format(DATE_FORMAT),\n        startDate: model.get('startDate').format(DATE_FORMAT),\n        calendar:  model.get('calendar'),\n      }));\n\n      // Create the flatpickr after.\n      this.flatpickr = flatpickr('#date_start', {\n        dateFormat: 'Y-m-d',\n        plugins: [ new rangePlugin({ input: '#date_end' }) ],\n      });\n\n      return $form;\n    }\n  }\n\n  /**\n   * Document ready!\n   *\n   * @return {void}\n   */\n  $(function() {\n    new BookingScheduler;\n  });\n\n})(jQuery);\n"],"file":"page-calendar.js"}