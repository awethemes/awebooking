{"version":3,"names":[],"mappings":"","sources":["admin/edit-room-type.js"],"sourcesContent":["(function($, plugin) {\n  'use strict';\n\n  /**\n   * Main room type meta-box class.\n   */\n  class RoomTypeMetabox {\n    /**\n     * Constructor\n     *\n     * @return {void}\n     */\n    constructor() {\n      this.$metabox = $('#awebooking-room-type-data');\n\n      // Handle click on tabs.\n      this.$metabox.on('click', '.awebooking-tabs a', this.handleClickTab.bind(this));\n      $('.awebooking-tabs > li:first > a', this.$metabox).trigger('click');\n\n      // Handle rooms.\n      this.sortableRooms = new Sortable($('.js-sorting-rooms')[0], {\n        handle: '.abrs-sortable__handle',\n        animation: 150,\n      });\n\n      this.$metabox.on('click', '.js-add-room', this.handleAddRoom.bind(this));\n      this.$metabox.on('click', '.js-scaffold-rooms', this.handleScaffoldRooms.bind(this));\n    }\n\n    /**\n     * Handle click on tab.\n     *\n     * @param  {Event]} e\n     * @return {void}\n     */\n    handleClickTab(e) {\n      e.preventDefault();\n\n      const $target = $(e.target);\n\n      $('.awebooking-tabs > li.active', this.$metabox).removeClass('active');\n      $target.parent().addClass('active');\n\n      $('.awebooking-tabs-panels > div', this.$metabox).hide();\n      $($target.attr('href'), this.$metabox).show();\n    }\n\n    handleAddRoom(e) {\n      e.preventDefault();\n\n      const title = (new String($('#title').val())).trim();\n      const template = wp.template('template-room-item');\n\n      const i = -1;\n      $('.js-list-rooms').append(template({\n        index:   i,\n        id:      -1,\n        name:   `${title} ${i+1}`,\n        prefix: `_rooms[${i}]`,\n      }));\n    }\n\n    /**\n     * Handle scaffold rooms.\n     *\n     * @param  {Event]} e\n     * @return {void}\n     */\n    handleScaffoldRooms(e) {\n      e.preventDefault();\n\n      let title = (new String($('#title').val())).trim();\n\n      let total = $('[name=\"_scaffold_number_rooms\"]', this.$metabox).val();\n      total = parseInt(total, 10);\n\n      let htmlRooms = '';\n      const template = wp.template('template-room-item');\n\n      for (var i = 0; i < total; i++) {\n        htmlRooms = htmlRooms + template({\n          index:   i,\n          id:      -1,\n          name:   `${title} ${i+1}`,\n          prefix: `_scaffold_rooms[${i}]`,\n        });\n      }\n\n      $('.js-list-rooms').show().html(htmlRooms);\n    }\n  }\n\n  // Document ready!\n  $(function() {\n    plugin.instances.roomtype_metabox = new RoomTypeMetabox;\n  });\n\n  /**\n   * Scroll to first checked category.\n   *\n   * @link https://github.com/scribu/wp-category-checklist-tree/blob/master/category-checklist-tree.php\n   */\n  $(function() {\n    $('[id$=\"-all\"] > ul.categorychecklist').each(function() {\n      const $list = $(this);\n      const $firstChecked = $list.find(':checked').first();\n\n      if (! $firstChecked.length) {\n        return;\n      }\n\n      const posFirst = $list.find('input').position().top;\n      const posChecked = $firstChecked.position().top;\n\n      $list.closest('.tabs-panel').scrollTop(posChecked - posFirst + 5);\n    });\n  });\n\n})(jQuery, window.awebooking);\n"],"file":"edit-room-type.js"}