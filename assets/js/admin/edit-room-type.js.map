{"version":3,"names":[],"mappings":"","sources":["admin/edit-room-type.js"],"sourcesContent":["(function($, plugin) {\r\n  'use strict';\r\n\r\n  /**\r\n   * Main room type meta-box class.\r\n   */\r\n  class RoomTypeMetabox {\r\n    /**\r\n     * Constructor\r\n     *\r\n     * @return {void}\r\n     */\r\n    constructor() {\r\n      this.$metabox = $('#awebooking-room-type-data');\r\n\r\n      // Handle click on tabs.\r\n      this.$metabox.on('click', '.awebooking-tabs a', this.handleClickTab.bind(this));\r\n      $('.awebooking-tabs > li:first > a', this.$metabox).trigger('click');\r\n\r\n      // Handle rooms.\r\n      this.sortableRooms = new Sortable($('.js-sorting-rooms')[0], {\r\n        handle: '.abrs-sortable__handle',\r\n        animation: 150,\r\n      });\r\n\r\n      this.$metabox.on('click', '.js-add-room', this.handleAddRoom.bind(this));\r\n      this.$metabox.on('click', '.js-scaffold-rooms', this.handleScaffoldRooms.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Handle click on tab.\r\n     *\r\n     * @param  {Event]} e\r\n     * @return {void}\r\n     */\r\n    handleClickTab(e) {\r\n      e.preventDefault();\r\n\r\n      const $target = $(e.target);\r\n\r\n      $('.awebooking-tabs > li.active', this.$metabox).removeClass('active');\r\n      $target.parent().addClass('active');\r\n\r\n      $('.awebooking-tabs-panels > div', this.$metabox).hide();\r\n      $($target.attr('href'), this.$metabox).show();\r\n    }\r\n\r\n    handleAddRoom(e) {\r\n      e.preventDefault();\r\n\r\n      const title = (new String($('#title').val())).trim();\r\n      const template = wp.template('template-room-item');\r\n\r\n      const i = -1;\r\n      $('.js-list-rooms').append(template({\r\n        index:   i,\r\n        id:      -1,\r\n        name:   `${title} ${i+1}`,\r\n        prefix: `_rooms[${i}]`,\r\n      }));\r\n    }\r\n\r\n    /**\r\n     * Handle scaffold rooms.\r\n     *\r\n     * @param  {Event]} e\r\n     * @return {void}\r\n     */\r\n    handleScaffoldRooms(e) {\r\n      e.preventDefault();\r\n\r\n      let title = (new String($('#title').val())).trim();\r\n\r\n      let total = $('[name=\"_scaffold_number_rooms\"]', this.$metabox).val();\r\n      total = parseInt(total, 10);\r\n\r\n      let htmlRooms = '';\r\n      const template = wp.template('template-room-item');\r\n\r\n      for (var i = 0; i < total; i++) {\r\n        htmlRooms = htmlRooms + template({\r\n          index:   i,\r\n          id:      -1,\r\n          name:   `${title} ${i+1}`,\r\n          prefix: `_scaffold_rooms[${i}]`,\r\n        });\r\n      }\r\n\r\n      $('.js-list-rooms').show().html(htmlRooms);\r\n    }\r\n  }\r\n\r\n  // Document ready!\r\n  $(function() {\r\n    plugin.instances.roomtype_metabox = new RoomTypeMetabox;\r\n  });\r\n\r\n  /**\r\n   * Scroll to first checked category.\r\n   *\r\n   * @link https://github.com/scribu/wp-category-checklist-tree/blob/master/category-checklist-tree.php\r\n   */\r\n  $(function() {\r\n    $('[id$=\"-all\"] > ul.categorychecklist').each(function() {\r\n      const $list = $(this);\r\n      const $firstChecked = $list.find(':checked').first();\r\n\r\n      if (! $firstChecked.length) {\r\n        return;\r\n      }\r\n\r\n      const posFirst = $list.find('input').position().top;\r\n      const posChecked = $firstChecked.position().top;\r\n\r\n      $list.closest('.tabs-panel').scrollTop(posChecked - posFirst + 5);\r\n    });\r\n  });\r\n\r\n})(jQuery, window.awebooking);\r\n"],"file":"edit-room-type.js"}