{"version":3,"names":[],"mappings":"","sources":["admin/settings.js"],"sourcesContent":["(function($, plugin) {\n  'use strict';\n\n  const settings = window._awebookingSettings || {};\n\n  /**\n   * Handle leaving using window.onbeforeunload.\n   *\n   * @return {void}\n   */\n  function handleLeaving() {\n    let changed = false;\n\n    // Set the changed if any controls fire change.\n    $('input, textarea, select').on( 'change', function() {\n      changed = true;\n    });\n\n    $('.awebooking-settings')\n      .on('click', '.nav-tab-wrapper a', function() {\n        if (changed) {\n          window.onbeforeunload = function() {\n            return settings.i18n.nav_warning;\n          };\n        } else {\n          window.onbeforeunload = null;\n        }\n      })\n      .on('click', '.submit button', function() {\n        window.onbeforeunload = null;\n      });\n  }\n\n  /**\n   * Init the datepicker.\n   *\n   * @return {void}\n   */\n  function initDatepicker() {\n    $('#display_datepicker_disabledates').flatpickr({\n      mode: 'multiple',\n      dateFormat: 'Y-m-d'\n    });\n  }\n\n  /**\n   * Setup input table bindings.\n   *\n   * @return {void}\n   */\n  function setupInputTable() {\n    const $table = $('.awebooking-input-table');\n\n    let shifted, controlled, hasFocus;\n    shifted = controlled = hasFocus = false;\n\n    $(document).bind('keyup keydown', function (e) {\n      shifted = e.shiftKey;\n      controlled = e.ctrlKey || e.metaKey;\n    });\n\n    const handleClickInputTable = function(el, e) {\n      var $elRow = $(el).closest('tr');\n      var $elTable = $(el).closest('table, tbody');\n\n      if ((e.type === 'focus' && hasFocus !== $elRow.index()) || (e.type === 'click' && $(el).is(':focus'))) {\n        hasFocus = $elRow.index();\n\n        if (!shifted && !controlled) {\n          $('tr', $elTable).removeClass('current').removeClass('last-selected');\n          $elRow.addClass('current').addClass('last-selected');\n        } else if (shifted) {\n          $('tr', $elTable).removeClass('current');\n          $elRow.addClass('selected-now').addClass('current');\n\n          if ($('tr.last-selected', $elTable).length > 0) {\n            if ($elRow.index() > $('tr.last-selected', $elTable).index()) {\n              $('tr', $elTable).slice($('tr.last-selected', $elTable).index(), $elRow.index()).addClass('current');\n            } else {\n              $('tr', $elTable).slice($elRow.index(), $('tr.last-selected', $elTable).index() + 1).addClass('current');\n            }\n          }\n\n          $('tr', $elTable).removeClass('last-selected');\n          $elRow.addClass('last-selected');\n        } else {\n          $('tr', $elTable).removeClass('last-selected');\n          if (controlled && $(el).closest('tr').is('.current')) {\n            $elRow.removeClass('current');\n          } else {\n            $elRow.addClass('current').addClass('last-selected');\n          }\n        }\n\n        $('tr', $elTable).removeClass('selected-now');\n      }\n    };\n\n    const handleRemoveRows = function (el, e) {\n      var $tbody = $(el).closest('table').find('tbody');\n\n      if ($tbody.find('tr.current').length > 0) {\n        var $current = $tbody.find('tr.current');\n\n        $current.each(function () {\n          $(this).remove();\n        });\n      }\n    };\n\n    $table\n      .on('blur', 'input', () => {\n        hasFocus = false;\n      })\n      .on('focus click', 'input', function (e) {\n        handleClickInputTable(this, e);\n      })\n      .on('click', '.remove_rows', function (e) {\n        e.preventDefault();\n        handleRemoveRows(this, e);\n      });\n  }\n\n  function setupInputTableSortable() {\n    /*$('.wc_input_table.sortable tbody').sortable({\n      items: 'tr',\n      cursor: 'move',\n      axis: 'y',\n      scrollSensitivity: 40,\n      forcePlaceholderSize: true,\n      helper: 'clone',\n      opacity: 0.65,\n      placeholder: 'wc-metabox-sortable-placeholder',\n      start: function (event, ui) {\n        ui.item.css('background-color', '#f6f6f6');\n      },\n      stop: function (event, ui) {\n        ui.item.removeAttr('style');\n      }\n    });\n\n    // Focus on inputs within the table if clicked instead of trying to sort.\n    $('.wc_input_table.sortable tbody input').on('click', function () {\n      $(this).focus();\n    });*/\n  }\n\n  /** Document ready */\n  $(function() {\n    handleLeaving();\n    initDatepicker();\n\n    setupInputTable();\n    // setupInputTableSortable();\n  });\n\n})(jQuery, window.awebooking);\n"],"file":"settings.js"}