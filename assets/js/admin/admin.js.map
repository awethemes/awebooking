{"version":3,"sources":["admin/admin.js"],"names":["$","awebooking","window","utils","instances","route","admin_route","replace","confirm","message","callback","swal","i18n","warning","toast","text","type","position","reverseButtons","buttonsStyling","showCancelButton","cancelButtonClass","confirmButtonClass","cancelButtonText","cancel","confirmButtonText","ok","then","result","value","createForm","action","method","$form","hiddenInput","append","appendTo","initSearchCustomer","$selectors","ajaxSearch","query","ajax","url","data","term","encodeURIComponent","error","success","res","each","selectize","valueField","labelField","searchField","dropdownParent","placeholder","load","length","tippy","arrow","animation","duration","fn","allowEmptyOption","on","e","preventDefault","link","attr","submit","jQuery"],"mappings":"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","sourcesContent":["(function($) {\n  'use strict';\n\n  const awebooking = window.awebooking || {};\n\n  // Create the properties.\n  awebooking.utils = {};\n  awebooking.instances = {};\n\n  /**\n   * The admin route.\n   *\n   * @param  {string} route\n   * @return {string}\n   */\n  awebooking.route = function(route) {\n    return this.admin_route + route.replace(/^\\//g, '');\n  }\n\n  /**\n   * Show the confirm message.\n   *\n   * @return {SweetAlert}\n   */\n  awebooking.confirm = function(message, callback) {\n    if (! window.swal) {\n      return window.confirm(message || this.i18n.warning) && callback();\n    }\n\n    const confirm = swal({\n      toast: true,\n      text: message || this.i18n.warning,\n      type: 'warning',\n      position: 'center',\n      reverseButtons: true,\n      buttonsStyling: false,\n      showCancelButton: true,\n      cancelButtonClass: 'button',\n      confirmButtonClass: 'button button-primary',\n      cancelButtonText: this.i18n.cancel,\n      confirmButtonText: this.i18n.ok,\n    });\n\n    if (callback) {\n      return confirm.then(function(result) {\n        if (result.value) callback(result);\n      });\n    }\n\n    return confirm;\n  },\n\n  /**\n   * Create a form then append to body.\n   *\n   * @param  {string} link   The form action.\n   * @param  {string} method The form method.\n   * @return {Object}\n   */\n  awebooking.createForm = function(action, method) {\n    const $form = $('<form>', { 'method': 'POST', 'action': action });\n\n    const hiddenInput = $('<input>', { 'name': '_method',  'type': 'hidden', 'value': method });\n\n    return $form.append(hiddenInput).appendTo('body');\n  };\n\n  /**\n   * Init the search customers.\n   *\n   * @return {void}\n   */\n  awebooking.utils.initSearchCustomer = function() {\n    const $selectors = $('select.awebooking-search-customer, .selectize-search-customer .cmb2_select');\n\n    const ajaxSearch = function(query, callback) {\n      $.ajax({\n        type: 'GET',\n        url: awebooking.route( '/search/customers' ),\n        data: { term: encodeURIComponent(query) },\n        error: function() { callback(); },\n        success: function(res) { callback(res); }\n      });\n    };\n\n    $selectors.each(function() {\n      $(this).selectize({\n        valueField: 'id',\n        labelField: 'display',\n        searchField: 'display',\n        dropdownParent: 'body',\n        placeholder: $(this).data('placeholder'),\n        load: function(query, callback) {\n          if (! query.length) {\n            return callback();\n          }\n\n          ajaxSearch(query, callback);\n        },\n      });\n\n    });\n  }\n\n  $(function() {\n    // Init tippy.\n    if (window.tippy) {\n      tippy('.tippy', {\n        arrow: true,\n        animation: 'shift-toward',\n        duration: [200, 150],\n      });\n    }\n\n    // Init the selectize.\n    if ($.fn.selectize) {\n      $('select.selectize, .with-selectize .cmb2_select').selectize({\n        allowEmptyOption: true,\n        searchField: ['value', 'text'],\n      });\n\n      awebooking.utils.initSearchCustomer();\n    }\n\n    // Init warning before delete.\n    $('[data-method=\"abrs-delete\"]').on( 'click', function(e) {\n      e.preventDefault();\n\n      const link = $(this).attr('href');\n      const message = $(this).data('warning');\n\n      awebooking.confirm(message, function() {\n        awebooking.createForm(link, 'DELETE').submit();\n      });\n    });\n  });\n\n})(jQuery);\n"],"file":"admin.js"}